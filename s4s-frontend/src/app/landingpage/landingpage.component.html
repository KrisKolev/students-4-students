<!--div class="image"></div-->
<!--id="landingPage_Map"-->

<div class="maps-container" [@extendMap]="isTopLocationsVisible ? 'closed' : 'open'">
    <google-map
        #googleMap
        [zoom]="zoom"
        width="100%"
        height="100%"
        [center]="center"
        [options]="options"
        (mapClick)="onMapClick($event)">
        <map-marker
                markerElem="mapMarker"
                *ngFor="let marker of mapMarkers"
                [position]="marker.position"
                [label]="marker.label"
                [title]="marker.title"
                [options]="marker.options"></map-marker>
        <map-marker
                markerElem="mapMarkerExisting"
                *ngFor="let marker of mapMarkersSights"
                [position]="marker.position"
                [label]="marker.label"
                [title]="marker.title"
                [options]="marker.options"
                [icon]="marker.icon"
                (mapClick)="showDetailsOfMarker(marker)"></map-marker>
    </google-map>
</div>

<div class="top-locations-container" *ngIf="isTopLocationsVisible" [@extendLocations]="isTopLocationsVisible ? 'open' : 'closed'" [@moveSightsDetails]="isSightDetailVisible ? 'open' : 'closed'">
    <div>

        <h2>Here are locations near you</h2>
        <h3>{{currentLocationAddress}} </h3>


        <div *ngFor="let sight of allSightsSortedByDistance">
            <mat-expansion-panel [expanded]="sight.headerExpanded">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        <mat-label >
                            <strong [textContent]="sight.name"></strong>
                        </mat-label>

                        <br/>

                    </mat-panel-title>
                    <mat-panel-description>
                        <mat-label [textContent]="'     (' + sight.showDistanceString + ')'"></mat-label>
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <div class="card-detail" >

                    <mat-grid-list cols="2" rowHeight="2:1">
                        <mat-grid-tile>
                            <ngb-carousel>
                                <ng-template ngbSlide *ngFor="let image of sight.allImageUrl">
                                    <div class="picsum-img-wrapper">
                                        <img [src]="image" alt="Random slide">
                                    </div>
                                </ng-template>
                            </ngb-carousel>
                            <mat-label *ngIf="sight.allImageUrl.length<1">No images available</mat-label>
                        </mat-grid-tile>
                        <mat-grid-tile>
                            <button class="sight-show-detail-btn" mat-raised-button (click)="onGoToSight(sight)">Details</button>
                            <button class="sight-show-detail-btn" mat-raised-button (click)="calcRoute(sight)">Show Route</button>
                        </mat-grid-tile>
                    </mat-grid-list>


                    <app-star-rating width="100px" [clickable]="true" [starCount]="5" [rating]="sight.overallRating"></app-star-rating>

                    <br/>
                    <mat-label><strong>Address: </strong></mat-label>
                    <mat-label [textContent]="sight.address"></mat-label>
                    <br/>
                </div>
            </mat-expansion-panel>

        </div>
    </div>
</div>


<div [@moveSightsDetailsContainer]="isSightDetailVisible ? 'open' : 'closed'" class="sight-details-view">
    <button mat-raised-button class="close-button-detail"
    (click)="onCloseSightDetail()">X</button>

    <mat-card-title ><strong>{{detailedSight.name}}</strong></mat-card-title>
    <mat-label><strong>Address: </strong></mat-label>
    <mat-label [textContent]="detailedSight.address"></mat-label>
    <br/>
    <mat-label><strong>Comments</strong></mat-label>
    <br/>

    <div *ngFor="let rat of detailedSight.ratingList">
        <app-rating-component [rating]="rat" class="sight-details-view-rating"></app-rating-component>
    </div>


    <br/>
</div>

<div class="maps-gotolocation" [@moveMapButtons]="isTopLocationsVisible ? 'open' : 'closed'">
    <mat-card-actions>
        <button class="map-action-button" mat-raised-button (click)="onGoToLocation()" background-color="primary">
            Go to your location
        </button>
    </mat-card-actions>
</div>

<div class="maps-toggleTopLocations" [@moveLocationButton]="isTopLocationsVisible ? 'open' : 'closed'">
    <mat-card-actions>
        <button class="map-action-button" mat-raised-button (click)="onToggleTopLocations(false)" background-color="primary">
            {{toggleTopLocationsText}}
        </button>
    </mat-card-actions>
</div>

<div class="maps-filter-sights-button" [@moveFilterButtonContainer]="isTopLocationsVisible ? 'open' : 'closed'">
    <mat-card-actions>
        <button class="map-action-button" mat-raised-button (click)="onShowFilter()" background-color="primary"
        [textContent]="isFilterVisible ? 'Hide Filter':'Show Filter'">
        </button>
    </mat-card-actions>
</div>

<div class="maps-clear-route" *ngIf="routeEnabled">
    <mat-card-actions>
        <button class="map-clear-route-button" mat-raised-button (click)="onClearRoutes()" background-color="primary">
            Clear route
        </button>
    </mat-card-actions>
</div>

<div class="filter-sights-container" *ngIf="isFilterVisible">
    <form class="filter-form">
        <mat-form-field appearance="fill" class="mat--fo">
            <mat-label class="label-select-filter">Distance (km)</mat-label>
            <input type="number" matInput
                   placeholder="10"
                   matNativeControl
                   #radiusInput
                   value="20"
                   class="label-select-filter">
        </mat-form-field>
    </form>

    <mat-form-field appearance="fill" class="filter-form-field">
        <mat-label class="label-select-filter">Sorting mode</mat-label>
        <mat-select matNativeControl required class="mat-select-content" [(value)]="filterModeValue" (selectionChange)="onFilterModeChange($event)">
            <mat-option value="distancedescending" >Distance descending</mat-option>
            <mat-option value="distanceascending">Distance ascending</mat-option>
            <mat-option value="ratingsdescending">Ratings descending</mat-option>
            <mat-option value="ratingsascending">Ratings ascending</mat-option>
        </mat-select>
    </mat-form-field>

    <div class="filter-center">
        <button class="map-action-button" mat-raised-button (click)="onApplyFilter(radiusInput)" background-color="primary"
        >Apply
        </button>
    </div>



</div>

<!--div which css moves the autocomplete to the left of the searchbar-->
<div matAutocompleteOrigin #origin="matAutocompleteOrigin" class="sights-search-panel" [style.visibility]="'hidden'"></div>

<!--searchbar across sights and GM-->
<div class="map-search-adressbar">
    <form class="address-form">
        <mat-form-field appearance="fill" >
            <mat-label class="address-placeholder-label">Search by sight, label or address</mat-label>
            <input width="300px"
                   type="text"
                   matInput
                   class="address-bar"
                   autocorrect="off"
                   autocapitalize="off"
                   spellcheck="off"
                   type="text"
                   [matAutocomplete]="auto"
                   [matAutocompleteConnectedTo]="origin"
                   [formControl]="sightSearchCtrl"
                   #addressSearch
                   [(ngModel)]="addressValue">
        </mat-form-field>
        <!--each individual field in the sights autocomplete-->
        <!--also, couldn't get the showDistanceString and overallRating not to show as errors, but they do work-->
        <mat-autocomplete #auto="matAutocomplete" class="address-autocomplete">
            <mat-option *ngFor="let sight of searchedSights | async" [value]="sight.name" (onSelectionChange)="onSearchSelectItem(sight)">
                {{sight.name}}
                <mat-label [textContent]="'(' + sight.showDistanceString + ')'"></mat-label>
                <!--<app-star-rating class="search-stars"  [clickable]="false" [starCount]="5" [rating]="sight.overallRating"></app-star-rating>-->
            </mat-option>
        </mat-autocomplete>
    </form>
</div>
